<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق تلاوات </title>
    
    <link rel="stylesheet" href="fontawesome-free-6.4.0-web/css/all.min.css">
    
    <style>
        @font-face {
            font-family: 'Cairo';
            font-style: normal;
            font-weight: 400;
            src: url('fonts/Cairo-Regular.ttf') format('ttf');
        }
        @font-face {
            font-family: 'Cairo';
            font-style: normal;
            font-weight: 600;
            src: url('fonts/Cairo-SemiBold.woff2') format('woff2');
        }
        @font-face {
            font-family: 'Cairo';
            font-style: normal;
            font-weight: 700;
            src: url('fonts/Cairo-Bold.woff2') format('woff2');
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', 'Cairo', sans-serif; }
        :root {
            --primary: #0288d1;
            --bg-light: #f0f7ff;
            --white: #ffffff;
            --text-main: #263238;
            --shadow: 0 8px 20px rgba(2, 136, 209, 0.08);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        body { background: var(--bg-light); color: var(--text-main); overflow-x: hidden; font-size: 13px; }
        .page { display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: var(--bg-light); z-index: 1; overflow-y: auto; }
        .page.active { display: block; }
        .header { display: flex; justify-content: space-between; padding: 14px 12px; align-items: center; background: var(--white); box-shadow: 0 1px 6px rgba(0,0,0,0.04); position: sticky; top: 0; z-index: 10; }
        .page-title { font-size: 13px; color: var(--primary); font-weight: 600; }
        .back-btn { font-size: 16px; cursor: pointer; color: var(--text-main); }
        .sidebar {
            position: fixed; top: 0; right: -240px; width: 240px; height: 100%;
            background: var(--white); z-index: 1000; transition: var(--transition);
            box-shadow: -4px 0 15px rgba(0,0,0,0.08); padding: 16px;
        }
        .sidebar.active { right: 0; }
        .sidebar-header { padding-bottom: 16px; border-bottom: 1px solid #eee; margin-bottom: 16px; text-align: center; }
        .sidebar-item { padding: 12px; display: flex; align-items: center; gap: 12px; color: var(--text-main); text-decoration: none; border-radius: 10px; transition: 0.2s; cursor: pointer; font-size: 13px; }
        .sidebar-item:hover { background: var(--bg-light); color: var(--primary); }
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.3); z-index: 999; display: none; }
        .overlay.active { display: block; }
        .search-container { padding: 12px; }
        .search-box {
            background: var(--white); display: flex; align-items: center; padding: 9px 14px;
            border-radius: 12px; box-shadow: var(--shadow);
        }
        .search-box input { border: none; outline: none; width: 100%; padding-right: 8px; font-size: 12px; }
        .main-card {
            margin: 0 12px 14px; background: linear-gradient(135deg, var(--primary), #4fc3f7);
            border-radius: 18px; padding: 18px; color: white; position: relative; overflow: hidden;
            box-shadow: 0 12px 28px rgba(2, 136, 209, 0.25);
        }
        .main-card i.bg-icon { position: absolute; left: -16px; bottom: -16px; font-size: 110px; opacity: 0.1; }
        .mini-player {
            position: fixed; bottom: 70px; left: 12px; right: 12px; 
            background: var(--white); padding: 9px 14px; border-radius: 14px;
            display: flex; align-items: center; gap: 12px; box-shadow: var(--shadow);
            z-index: 100; border: 1px solid rgba(2,136,209,0.08); cursor: pointer;
            transition: var(--transition);
            transform: translateY(0);
            opacity: 1;
        }
        .mini-player.hidden {
            transform: translateY(80px);
            opacity: 0;
            pointer-events: none;
        }
        .mini-info { flex: 1; }
        .mini-info h4 { font-size: 12px; }
        .mini-info p { font-size: 10px; color: #78909c; }
        .close-mini {
            color: #78909c;
            font-size: 14px;
            cursor: pointer;
            padding: 4px;
        }
        .track-list { padding: 0 12px 80px; }
        .track-card {
            background: var(--white); padding: 12px; border-radius: 12px;
            display: flex; align-items: center; gap: 12px; margin-bottom: 9px;
            transition: var(--transition); cursor: pointer; border: 1px solid transparent;
        }
        .track-card:active { transform: scale(0.98); }
        .track-card.active { border-color: var(--primary); background: #e1f5fe; }
        .track-num { width: 28px; height: 28px; background: var(--bg-light); border-radius: 7px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: var(--primary); font-size: 12px; }
        .controls-btns { display: flex; gap: 12px; align-items: center; }
        .play-sm { width: 34px; height: 34px; border-radius: 50%; background: var(--primary); color: white; display: flex; align-items: center; justify-content: center; border: none; font-size: 12px; }
        .full-player {
            background: linear-gradient(135deg, var(--primary), #4fc3f7); min-height: 100vh; color: white; padding: 16px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;
        }
        .full-player-image { width: 220px; height: 220px; background: rgba(255,255,255,0.1); border-radius: 18px; display: flex; align-items: center; justify-content: center; margin: 25px 0; border: 4px solid rgba(255,255,255,0.2); }
        .full-player-image i { font-size: 100px; opacity: 0.8; }
        .player-title { font-size: 24px; margin-bottom: 8px; }
        .player-artist { font-size: 16px; opacity: 0.9; margin-bottom: 35px; }
        .player-controls { display: flex; align-items: center; justify-content: center; gap: 25px; margin: 35px 0; }
        .player-controls i { font-size: 22px; cursor: pointer; padding: 14px; }
        .player-main-btn { width: 65px; height: 65px; border-radius: 50%; background: white; color: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 22px; }
        .progress-container { width: 100%; margin: 18px 0; padding: 0 16px; }
        .progress-bar { width: 100%; height: 5px; background: rgba(255,255,255,0.3); border-radius: 2px; margin: 9px 0; position: relative; cursor: pointer; }
        .progress { width: 0%; height: 100%; background: white; border-radius: 2px; position: absolute; top: 0; left: 0; transition: width 0.1s linear; }
        .time-info { display: flex; justify-content: space-between; width: 100%; padding: 0 16px; font-size: 13px; opacity: 0.8; }
        
        .nav-item { text-align: center; color: #90a4ae; text-decoration: none; font-size: 10px; cursor: pointer; }
        .nav-item.active { color: var(--primary); }
        .empty-state { text-align: center; padding: 40px 12px; color: #78909c; }
        .empty-state i { font-size: 40px; margin-bottom: 14px; opacity: 0.5; }
        .notification {
            position: fixed;
            top: 60px;
            right: 50%;
            transform: translateX(50%) translateY(-20px);
            background: var(--primary);
            color: white;
            padding: 9px 18px;
            border-radius: 9px;
            box-shadow: 0 8px 24px rgba(2, 136, 209, 0.25);
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            font-weight: 500;
            text-align: center;
            max-width: 250px;
            width: 90%;
            pointer-events: none;
            font-size: 12px;
        }
        .notification.show {
            opacity: 1;
            transform: translateX(50%) translateY(0);
        }
        .notification.success { background: #FF9800; }
        .notification.info { background: #FF9800; }
        .notification.warning { background: #FF9800; }
        .share-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
            width: 100%;
        }
        .share-btn {
            display: flex;
            align-items: center;
            gap: 12px;
            background: white;
            padding: 14px;
            border-radius: 12px;
            border: none;
            width: 100%;
            text-align: right;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        .share-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 28px rgba(2, 136, 209, 0.15); }
        .share-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }
        .share-text { flex: 1; text-align: right; }
        .share-text h3 { font-size: 14px; margin-bottom: 2px; color: var(--text-main); }
        .share-text p { font-size: 11px; color: #78909c; }
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 20px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 14px;
            width: 14px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(24px); }
    </style>
</head>
<body>
  <div class="notification" id="notification"></div>
  
  <div class="overlay" id="overlay"></div>
<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h3 style="color: var(--primary)">تلاوات </h3>
        <p style="font-size: 12px">الإصدار 1.0</p>
    </div>
    <a href="#" class="sidebar-item" data-page="quran"><i class="fas fa-mosque"></i> التلاوات </a>
    <a href="#" class="sidebar-item" data-page="favorites"><i class="fas fa-star"></i> المفضلة</a>
    <a href="#" class="sidebar-item" data-page="about"><i class="fas fa-info-circle"></i> عن التطبيق</a>
    <a href="#" class="sidebar-item" data-page="share"><i class="fas fa-share-nodes"></i> مشاركة التطبيق</a>
</div>

<div class="page active" id="home-page">
    <div class="header">
        <i class="fas fa-bars-staggered" id="menuBtn" style="font-size: 20px; cursor: pointer;"></i>
        <h2 class="page-title">الرئيسية</h2>
        <div style="width: 20px;"></div>
    </div>

    <div class="search-container">
        <div class="search-box">
            <i class="fas fa-search" style="color: #b0bec5;"></i>
            <input type="text" id="searchInput" placeholder="ابحث عن سورة أو قارئ...">
        </div>
    </div>

    <div class="main-card">
        <i class="fas fa-mosque bg-icon"></i>
        <p style="font-size: 13px; opacity: 0.9;">أفضل التلاوات المختارة</p>
        <h2 style="margin: 4px 0 13px; font-size: 18px;">استمع لسكينة قلبك</h2>
        <button style="padding: 7px 18px; border-radius: 9px; border: none; background: white; color: var(--primary); font-weight: bold; font-size: 13px;" id="randomPlay">تشغيل عشوائي</button>
    </div>

    <div class="track-list" id="trackList"></div>
</div>

<div class="page" id="favorites-page">
    <div class="header">
        <i class="fas fa-arrow-right back-btn" data-page="home"></i>
        <h2 class="page-title">المفضلة</h2>
        <div style="width: 20px;"></div>
    </div>
    <div class="track-list" id="favoritesList">
        <div class="empty-state">
            <i class="far fa-star"></i>
            <h3>لا توجد تلاوات مفضلة</h3>
            <p>اضغط على القلب بجوار التلاوة لإضافتها للمفضلة</p>
        </div>
    </div>
</div>

<div class="page" id="recent-page">
    <div class="header">
        <i class="fas fa-arrow-right back-btn" data-page="home"></i>
        <h2 class="page-title">المستمع إليها مؤخراً</h2>
        <div style="width: 20px;"></div>
    </div>
    <div class="track-list" id="recentList">
        <div class="empty-state">
            <i class="far fa-clock"></i>
            <h3>لا توجد تلاوات مستمع إليها</h3>
            <p>سيتم عرض التلاوات التي تستمع إليها هنا</p>
        </div>
    </div>
</div>

<div class="page" id="player-page">
    <div class="full-player">
        <div style="width: 100%; text-align: left;">
            <i class="fas fa-arrow-left back-btn" data-page="home" style="font-size: 22px; color: white;"></i>
        </div>
        <div class="full-player-image">
            <i class="fas fa-mosque"></i>
        </div>
        <h1 class="player-title" id="fullTitle">سورة الفاتحة</h1>
        <p class="player-artist" id="fullArtist">عبد الباسط عبد الصمد</p>
        <div class="progress-container">
            <div class="progress-bar" id="progressContainer">
                <div class="progress" id="progressBar"></div>
            </div>
            <div class="time-info">
                <span id="currentTime">0:00</span>
                <span id="duration">0:00</span>
            </div>
        </div>
        <div class="player-controls">
            <i class="fas fa-redo" id="repeatBtn"></i>
            <i class="fas fa-step-backward" id="fullPrevBtn"></i>
            <div class="player-main-btn" id="fullPlayBtn">
                <i class="fas fa-play"></i>
            </div>
            <i class="fas fa-step-forward" id="fullNextBtn"></i>
            <i class="fas fa-heart" id="favoriteBtn"></i>
        </div>
    </div>
</div>

<div class="page" id="quran-page">
    <div class="header">
        <i class="fas fa-arrow-right back-btn" data-page="home"></i>
        <h2 class="page-title"><i class="fas fa-mosque" style="margin-left: 8px;"></i> التلاوات </h2>
        <div style="width: 20px;"></div>
    </div>
    <div class="track-list" id="quranList"></div>
</div>

<div class="page" id="about-page">
    <div class="header">
        <i class="fas fa-arrow-right back-btn" data-page="home"></i>
        <h2 class="page-title">عن التطبيق</h2>
        <div style="width: 20px;"></div>
    </div>
    <div style="padding: 25px 16px;">
        <div style="text-align: center; margin-bottom: 25px;">
            <div style="width: 90px; height: 90px; background: var(--bg-light); border-radius: 18px; margin: 0 auto 18px; display: flex; align-items: center; justify-content: center;">
                <i class="fas fa-mosque" style="font-size: 45px; color: var(--primary);"></i>
            </div>
            <h2 style="margin-bottom: 8px; font-size: 18px;">تلاوات </h2>
            <p style="color: var(--primary); margin-bottom: 4px; font-size: 14px;">الإصدار 1.0</p>
            <p style="color: #78909c; font-size: 13px;">تطبيق لتلاوات القرآن الكريم</p>
        </div>
        
        <div style="background: white; border-radius: 14px; padding: 18px; margin-bottom: 12px;">
            <h3 style="margin-bottom: 13px; color: var(--primary); font-size: 15px;"><i class="fas fa-info-circle" style="margin-left: 8px;"></i>معلومات عن التطبيق</h3>
            <p style="color: #555; line-height: 1.6; margin-bottom: 13px; font-size: 13px;">
                تطبيق تلاوات  هو تطبيق مجاني يهدف إلى تسهيل الاستماع إلى تلاوات القرآن الكريم بأصوات القراء.
            </p>
            <p style="color: #555; line-height: 1.6; font-size: 13px;">
                يحتوي التطبيق على مجموعة مميزة من التلاوات المختارة بعناية لتوفير تجربة استماع مريحة ومفيدة.
            </p>
        </div>
        
        <div style="background: white; border-radius: 14px; padding: 18px; margin-bottom: 12px;">
            <h3 style="margin-bottom: 13px; color: var(--primary); font-size: 15px;"><i class="fas fa-feather-alt" style="margin-left: 8px;"></i>المميزات</h3>
            <ul style="padding-right: 18px; color: #555;">
                <li style="margin-bottom: 8px; font-size: 13px;">تلاوات  لأفضل القراء</li>
                <li style="margin-bottom: 8px; font-size: 13px;">أصوات  مريحة وهادئة</li>
                <li style="margin-bottom: 8px; font-size: 13px;">إمكانية إضافة التلاوات للمفضلة</li>
                <li style="margin-bottom: 8px; font-size: 13px;">تتبع التلاوات المستمع إليها مؤخراً</li>
                <li style="font-size: 13px;">واجهة مستخدم بسيطة وسهلة</li>
            </ul>
        </div>
    </div>
</div>

<div class="page" id="share-page">
    <div class="header">
        <i class="fas fa-arrow-right back-btn" data-page="home"></i>
        <h2 class="page-title">مشاركة التطبيق</h2>
        <div style="width: 20px;"></div>
    </div>
    <div style="padding: 30px 16px; text-align: center;">
        <div style="width: 100px; height: 100px; background: var(--bg-light); border-radius: 18px; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-share-alt" style="font-size: 45px; color: var(--primary);"></i>
        </div>
        <h2 style="margin-bottom: 12px; font-size: 18px;">شارك بركة القرآن</h2>
        <p style="color: #78909c; margin-bottom: 25px; font-size: 13px;">شارك هذا التطبيق مع أحبابك لينالوا الأجر والثواب</p>
        
        <div class="share-buttons">
            <button class="share-btn" id="whatsappShare">
                <div class="share-icon" style="background: #25D366;">
                    <i class="fab fa-whatsapp"></i>
                </div>
                <div class="share-text">
                    <h3>مشاركة عبر واتساب</h3>
                    <p>شارك التطبيق مع أصدقائك على واتساب</p>
                </div>
            </button>
            
            <button class="share-btn" id="telegramShare">
                <div class="share-icon" style="background: #0088cc;">
                    <i class="fab fa-telegram"></i>
                </div>
                <div class="share-text">
                    <h3>مشاركة عبر تليجرام</h3>
                    <p>شارك التطبيق على قنوات تليجرام</p>
                </div>
            </button>
            
            <button class="share-btn" id="linkShare">
                <div class="share-icon" style="background: var(--primary);">
                    <i class="fas fa-link"></i>
                </div>
                <div class="share-text">
                    <h3>نسخ رابط التطبيق</h3>
                    <p>انسخ الرابط والصقه في أي مكان</p>
                </div>
            </button>
        </div>
    </div>
</div>

<div class="mini-player" id="miniPlayer">
    <div class="mini-info">
        <h4 id="miniTitle">سورة الفاتحة</h4>
        <p id="miniArtist">عبد الباسط عبد الصمد</p>
    </div>
    <div class="controls-btns">
        <i class="fas fa-step-backward" id="prevBtn" style="color: var(--primary); cursor: pointer;"></i>
        <button class="play-sm" id="playBtn"><i class="fas fa-play"></i></button>
        <i class="fas fa-step-forward" id="nextBtn" style="color: var(--primary); cursor: pointer;"></i>
    </div>
    <i class="fas fa-times close-mini" id="closeMiniPlayer"></i>
</div>

<nav class="nav-bottom">
    <div class="nav-item active" data-page="home"><i class="fas fa-house" style="font-size: 17px;"></i><br>الرئيسية</div>
    <div class="nav-item" data-page="favorites"><i class="fas fa-heart" style="font-size: 17px;"></i><br>المفضلة</div>
    <div class="nav-item" data-page="recent"><i class="fas fa-clock-rotate-left" style="font-size: 17px;"></i><br>الأخيرة</div>
</nav>

<script>
// طلب إذن الإشعارات فور تحميل التطبيق
window.addEventListener('load', function() {
    if ("Notification" in window) {
        Notification.requestPermission().then(permission => {
            if (permission !== "granted") {
                console.log("إذن الإشعارات مرفوض");
            }
        });
    }
});

    const surahs = [
    
    { id: 1, title: "وربك يخلق ما يشاء", reader: "عمر النبراوي", src: "mose/1.opus", favorite: false },
    { id: 2, title: "لَوْ أَنْزَلْنَا هَٰذَا الْقُرْآنَ عَلَىٰ جَبَلٍ", reader: "محمد الخريف", src: "mose/2.opus", favorite: false },
    { id: 3, title: "إن هذا القرآن يهدي للتي هي أقوم", reader: "أحمد التركي", src: "mose/3.opus", favorite: false },
    { id: 4, title: "يَا قَوْمَنَا أَجِيبُوا دَاعِيَ اللَّه", reader: "نايف العويد", src: "mose/4.opus", favorite: false },
    { id: 5, title: "ظَهَرَ الْفَسَادُ فِي الْبَرِّ وَالْبَحْرِ", reader: "بندر نعمان", src: "mose/5.opus", favorite: false },
    { id: 6, title: "سورة الفاتحة", reader: "ماهر المعيقلي", src: "mose/6.opus", favorite: false },
    { id: 7, title: "آية الكرسي", reader: "سعد الغامدي", src: "mose/7.opus", favorite: false },
    { id: 8, title: "خواتيم سورة البقرة", reader: "أحمد العجمي", src: "mose/8.opus", favorite: false },
    { id: 9, title: "سورة يوسف (مختصرة)", reader: "عبد الرحمن السديس", src: "mose/9.opus", favorite: false },
    { id: 10, title: "سورة الكهف (الأولى)", reader: "عبد الباسط عبد الصمد", src: "mose/10.opus", favorite: false },
    { id: 11, title: "سورة النور (آيات النور)", reader: "مشاري العفاسي", src: "mose/11.opus", favorite: false },
    { id: 12, title: "سورة يس", reader: "أبو بكر الشاطري", src: "mose/12.opus", favorite: false },
    { id: 13, title: "سورة الدخان", reader: "ياسر الدوسري", src: "mose/13.opus", favorite: false },
    { id: 14, title: "سورة الواقعة", reader: "خالد الجليل", src: "mose/14.opus", favorite: false },
    { id: 15, title: "سورة الحشر (آخر آيات)", reader: "فهد الكندري", src: "mose/15.opus", favorite: false },
    { id: 16, title: "سورة الملك", reader: "عبد الله بصفر", src: "mose/16.opus", favorite: false },
    { id: 17, title: "سورة القلم", reader: "أحمد بن علي العجمي", src: "mose/17.opus", favorite: false },
    { id: 18, title: "سورة النبأ", reader: "سعود الشريم", src: "mose/18.opus", favorite: false },
    { id: 19, title: "سورة التكوير", reader: "علي جابر", src: "mose/19.opus", favorite: false },
    { id: 20, title: "سورة الانفطار", reader: "عبد المحسن القاسم", src: "mose/20.opus", favorite: false },
    { id: 21, title: "سورة النازعات", reader: "محمد أيوب", src: "mose/21.opus", favorite: false },
    { id: 22, title: "سورة عبس", reader: "عبد الرشيد صوفي", src: "mose/22.opus", favorite: false },
    { id: 23, title: "سورة التين", reader: "محمود الحصري", src: "mose/23.opus", favorite: false },
    { id: 24, title: "سورة العلق", reader: "مصطفى إسماعيل", src: "mose/24.opus", favorite: false },
    { id: 25, title: "سورة القدر", reader: "كامل يوسف البهتيمي", src: "mose/25.opus", favorite: false },
    { id: 26, title: "سورة البينة", reader: "توفيق الصائغ", src: "mose/26.opus", favorite: false },
    { id: 27, title: "سورة الزلزلة", reader: "عبد الفتاح الشعشاعي", src: "mose/27.opus", favorite: false },
    { id: 28, title: "سورة العاديات", reader: "أحمد صابر", src: "mose/28.opus", favorite: false },
    { id: 29, title: "سورة القارعة", reader: "محمد رفعت", src: "mose/29.opus", favorite: false },
    { id: 30, title: "سورة التكاثر", reader: "محمد صديق المنشاوي", src: "mose/30.opus", favorite: false },
    { id: 31, title: "سورة العصر", reader: "عبد الباسط عبد الصمد", src: "mose/31.opus", favorite: false },
    { id: 32, title: "سورة الهمزة", reader: "محمد الخير", src: "mose/32.opus", favorite: false },
    { id: 33, title: "سورة الفيل", reader: "عبد العزيز الأحمد", src: "mose/33.opus", favorite: false },
    { id: 34, title: "سورة قريش", reader: "فيصل السعيد", src: "mose/34.opus", favorite: false },
    { id: 35, title: "سورة الماعون", reader: "ناصر القطامي", src: "mose/35.opus", favorite: false },
    { id: 36, title: "سورة الكوثر", reader: "عبد العزيز الزهراني", src: "mose/36.opus", favorite: false },
    { id: 37, title: "سورة الكافرون", reader: "علي الحذيفي", src: "mose/37.opus", favorite: false },
    { id: 38, title: "سورة النصر", reader: "صالح آل طالب", src: "mose/38.opus", favorite: false },
    { id: 39, title: "سورة المسد", reader: "بندر بليله", src: "mose/39.opus", favorite: false },
    { id: 40, title: "سورة الإخلاص", reader: "سليمان الرحيمي", src: "mose/40.opus", favorite: false },
    { id: 41, title: "سورة الرحمن", reader: "هزاع البلوشي", src: "mose/41.opus", favorite: false },
    { id: 42, title: "سورة الواقعة", reader: "عبد الله المطرود", src: "mose/42.opus", favorite: false },
    { id: 43, title: "سورة النجم", reader: "عبد المحسن الحارثي", src: "mose/43.opus", favorite: false },
    { id: 44, title: "سورة القمر", reader: "محمد المحيسني", src: "mose/44.opus", favorite: false },
    { id: 45, title: "سورة الصافات", reader: "أحمد النفيس", src: "mose/45.opus", favorite: false },
    { id: 46, title: "سورة ص", reader: "خليل الحصري", src: "mose/46.opus", favorite: false },
    { id: 47, title: "سورة الفرقان", reader: "مبتهل الغريب", src: "mose/47.opus", favorite: false },
    { id: 48, title: "سورة النمل", reader: "عبد العزيز الخليفي", src: "mose/48.opus", favorite: false },
    { id: 49, title: "سورة القصص", reader: "إدريس أبكر", src: "mose/49.opus", favorite: false },
    { id: 50, title: "سورة الشعراء", reader: "محمد جبريل", src: "mose/50.opus", favorite: false },
    { id: 51, title: "سورة الحج", reader: "عبد الله خياط", src: "mose/51.opus", favorite: false },
    { id: 52, title: "سورة طه", reader: "عبد الوهاب الطريري", src: "mose/52.opus", favorite: false },
    { id: 53, title: "سورة مريم", reader: "محمد الطبلاوي", src: "mose/53.opus", favorite: false },
    { id: 54, title: "سورة الكهف كاملة", reader: "عبد العزيز الأحمد", src: "mose/54.opus", favorite: false },
    { id: 55, title: "سورة الإسراء", reader: "عبد الله كامل", src: "mose/55.opus", favorite: false },
    { id: 56, title: "سورة النحل", reader: "عبد الرزاق الدليمي", src: "mose/56.opus", favorite: false },
    { id: 57, title: "سورة الحجر", reader: "محمد البراك", src: "mose/57.opus", favorite: false },
    { id: 58, title: "سورة إبراهيم", reader: "عبد العزيز الزهراني", src: "mose/58.opus", favorite: false },
    { id: 59, title: "سورة الرعد", reader: "عثمان التكروري", src: "mose/59.opus", favorite: false },
    { id: 60, title: "سورة يوسف كاملة", reader: "عبد الباري الثبيتي", src: "mose/60.opus", favorite: false },
    { id: 61, title: "سورة يونس", reader: "محمود الشيمي", src: "mose/61.opus", favorite: false },
    { id: 62, title: "سورة التوبة", reader: "عبد العزيز الكرعاني", src: "mose/62.opus", favorite: false },
    { id: 63, title: "سورة الأنفال", reader: "عبد الله المبارك", src: "mose/63.opus", favorite: false },
    { id: 64, title: "سورة الأعراف", reader: "محمد اللحيدان", src: "mose/64.opus", favorite: false },
    { id: 65, title: "سورة الأنعام", reader: "عبد الرحمن الحذيفي", src: "mose/65.opus", favorite: false },
    { id: 66, title: "سورة المائدة", reader: "عبد الله الجهني", src: "mose/66.opus", favorite: false },
    { id: 67, title: "سورة النساء", reader: "سعيد سالم", src: "mose/67.opus", favorite: false },
    { id: 68, title: "سورة آل عمران", reader: "عبد الهادي كناكري", src: "mose/68.opus", favorite: false },
    { id: 69, title: "سورة البقرة (أواخر)", reader: "عبد الله السعد", src: "mose/69.opus", favorite: false },
    { id: 70, title: "سورة الفجر", reader: "أحمد الحواشي", src: "mose/70.opus", favorite: false },
    { id: 71, title: "سورة البروج", reader: "محمد عثمان", src: "mose/71.opus", favorite: false },
    { id: 72, title: "سورة الطور", reader: "عبد الرحمن مسعد", src: "mose/72.opus", favorite: false },
    { id: 73, title: "سورة الذاريات", reader: "علي عبد الله جابر", src: "mose/73.opus", favorite: false },
    { id: 74, title: "سورة ق", reader: "عبد الله الميهوب", src: "mose/74.opus", favorite: false },
    { id: 75, title: "سورة الحاقة", reader: "سامي هاشم", src: "mose/75.opus", favorite: false },
    { id: 76, title: "سورة المعارج", reader: "عبد الله الشمراني", src: "mose/76.opus", favorite: false },
    { id: 77, title: "سورة نوح", reader: "عبد الله البراهيم", src: "mose/77.opus", favorite: false },
    { id: 78, title: "سورة الجن", reader: "عبد العظيم الحداد", src: "mose/78.opus", favorite: false },
    { id: 79, title: "سورة المزمل", reader: "محمد حسن", src: "mose/79.opus", favorite: false },
    { id: 80, title: "سورة المدثر", reader: "عبد الله السعيد", src: "mose/80.opus", favorite: false },
    { id: 81, title: "سورة القيامة", reader: "عبد الرحمن السمحان", src: "mose/81.opus", favorite: false },
    { id: 82, title: "سورة الإنسان", reader: "عبد العزيز الخضر", src: "mose/82.opus", favorite: false },
    { id: 83, title: "سورة المرسلات", reader: "عبد الله الفوزان", src: "mose/83.opus", favorite: false },
    { id: 84, title: "سورة النبأ", reader: "عبد المحسن المهنا", src: "mose/84.opus", favorite: false },
    { id: 85, title: "سورة النازعات", reader: "عبد العزيز الأحمد", src: "mose/85.opus", favorite: false },
    { id: 86, title: "سورة عبس", reader: "عبد الله باصفر", src: "mose/86.opus", favorite: false },
    { id: 87, title: "سورة التكوير", reader: "عبد الرحمن الدرويش", src: "mose/87.opus", favorite: false },
    { id: 88, title: "سورة الانفطار", reader: "عبد الله المطرود", src: "mose/88.opus", favorite: false },
    { id: 89, title: "سورة المطففين", reader: "عبد العزيز السلمان", src: "mose/89.opus", favorite: false },
    { id: 90, title: "سورة الانشقاق", reader: "عبد الرحمن الحريبي", src: "mose/90.opus", favorite: false },
    { id: 91, title: "سورة البروج", reader: "عبد المحسن القاسم", src: "mose/91.opus", favorite: false },
    { id: 92, title: "سورة الطارق", reader: "عبد الله بصفر", src: "mose/92.opus", favorite: false },
    { id: 93, title: "سورة الأعلى", reader: "عبد الرحمن السديس", src: "mose/93.opus", favorite: false },
    { id: 94, title: "سورة الغاشية", reader: "عبد الباري الثبيتي", src: "mose/94.opus", favorite: false },
    { id: 95, title: "سورة الفجر", reader: "سعود الشريم", src: "mose/95.opus", favorite: false },
    { id: 96, title: "سورة البلد", reader: "علي الحذيفي", src: "mose/96.opus", favorite: false },
    { id: 97, title: "سورة الشمس", reader: "عبد المحسن القاسم", src: "mose/97.opus", favorite: false },
    { id: 98, title: "سورة الليل", reader: "عبد الرحمن السديس", src: "mose/98.opus", favorite: false },
    { id: 99, title: "سورة الضحى", reader: "مشاري العفاسي", src: "mose/99.opus", favorite: false },
    { id: 100, title: "سورة الشرح", reader: "محمد الخريف", src: "mose/100.opus", favorite: false }
];

    let currentIndex = 0;
    let isPlaying = false;
    let isRepeat = false;
    const audio = new Audio();
    let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
    let recent = JSON.parse(localStorage.getItem('recent')) || [];

    function showNotification(message, type = 'info') {
        const notification = document.getElementById('notification');
        notification.textContent = message;
        notification.className = `notification show ${type}`;
        
        setTimeout(() => {
            notification.classList.remove('show');
        }, 2000);
    }

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
        document.getElementById(pageId + '-page').classList.add('active');
        document.querySelectorAll(`[data-page="${pageId}"]`).forEach(item => item.classList.add('active'));
        
        document.getElementById('sidebar').classList.remove('active');
        document.getElementById('overlay').classList.remove('active');
        
        const miniPlayer = document.getElementById('miniPlayer');
        if (pageId === 'home') {
            miniPlayer.classList.remove('hidden');
        } else {
            miniPlayer.classList.add('hidden');
        }
        
        if(pageId === 'favorites') renderFavorites();
        if(pageId === 'recent') renderRecent();
        if(pageId === 'quran') renderQuran();
        
        if (pageId === 'player') {
            setTimeout(setupProgressBar, 100);
        }
    }

    function closeSidebar() {
        document.getElementById('sidebar').classList.remove('active');
        document.getElementById('overlay').classList.remove('active');
    }

    document.querySelectorAll('.nav-item, .sidebar-item, .back-btn').forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            const page = item.dataset.page;
            if(page) {
                showPage(page);
            }
        });
    });

    document.getElementById('menuBtn').onclick = () => {
        document.getElementById('sidebar').classList.add('active');
        document.getElementById('overlay').classList.add('active');
    };

    document.getElementById('overlay').onclick = closeSidebar;

    document.getElementById('miniPlayer').onclick = (e) => {
        if (!e.target.closest('#closeMiniPlayer') && !e.target.closest('.play-sm') && !e.target.closest('#prevBtn') && !e.target.closest('#nextBtn')) {
            showPage('player');
            updatePlayer();
        }
    };

    document.getElementById('closeMiniPlayer').onclick = (e) => {
        e.stopPropagation();
        document.getElementById('miniPlayer').classList.add('hidden');
        showNotification('تم إخفاء المشغل المصغر', 'info');
    };

    document.getElementById('randomPlay').onclick = () => {
        const randomIndex = Math.floor(Math.random() * surahs.length);
        playSurah(randomIndex);
        showPage('player');
    };


const appLink = "https://your-specific-link.com"; 

document.getElementById('whatsappShare').onclick = function() {
    const shareText = "تطبيق تلاوات خاشعه- استمع إلى أجمل تلاوات القرآن الكريم\n\nقم بتنزيل التطبيق الآن واستمتع بتلاوات متنوعة لأشهر القراء\n\n" + appLink;
    const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(shareText)}`;
    window.open(whatsappUrl, '_blank');
    showNotification('جاري فتح واتساب للمشاركة', 'info');
};

document.getElementById('telegramShare').onclick = function() {
    const shareText = "تطبيق تلاوات خاشعه- استمع إلى أجمل تلاوات القرآن الكريم\n\nقم بتنزيل التطبيق الآن واستمتع بتلاوات متنوعة لأشهر القراء\n\n";
    const telegramUrl = `https://t.me/share/url?url=${encodeURIComponent(appLink)}&text=${encodeURIComponent(shareText)}`;
    window.open(telegramUrl, '_blank');
    showNotification('جاري فتح تليجرام للمشاركة', 'info');
};

document.getElementById('linkShare').onclick = function() {
    navigator.clipboard.writeText(appLink)
        .then(() => {
            showNotification('تم نسخ رابط التطبيق بنجاح', 'success');
        })
        .catch(err => {
            console.error('فشل نسخ النص: ', err);
            showNotification('حدث خطأ في نسخ الرابط', 'warning');
        });
};


    function renderSurahs(list = surahs) {
        const container = document.getElementById('trackList');
        container.innerHTML = list.map((s, index) => `
            <div class="track-card ${s.id === surahs[currentIndex].id ? 'active' : ''}" onclick="playSurah(${surahs.indexOf(s)})">
                <div class="track-num">${index + 1}</div>
                <div style="flex:1">
                    <h4 style="font-size: 14px;">${s.title}</h4>
                    <p style="font-size: 11px; color: #78909c;">${s.reader}</p>
                </div>
                <i class="fas fa-heart ${s.favorite ? 'fas' : 'far'}" style="color: ${s.favorite ? '#ff4757' : '#78909c'}; margin-right: 8px; font-size: 16px;" onclick="toggleFavorite(${s.id}, true); event.stopPropagation();"></i>
                <i class="fas fa-circle-play" style="color: var(--primary); font-size: 18px;"></i>
            </div>
        `).join('');
    }

    function renderQuran() {
        const container = document.getElementById('quranList');
        container.innerHTML = surahs.map((s, index) => `
            <div class="track-card" onclick="playSurah(${index})">
                <div class="track-num">${index + 1}</div>
                <div style="flex:1">
                    <h4 style="font-size: 14px;">${s.title}</h4>
                    <p style="font-size: 11px; color: #78909c;">${s.reader}</p>
                </div>
                <i class="fas fa-play-circle" style="color: var(--primary); font-size: 18px;"></i>
            </div>
        `).join('');
    }

    function renderFavorites() {
        const container = document.getElementById('favoritesList');
        const favSurahs = surahs.filter(s => favorites.includes(s.id));
        
        if(favSurahs.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="far fa-star"></i>
                    <h3>لا توجد تلاوات مفضلة</h3>
                    <p>اضغط على القلب بجوار التلاوة لإضافتها للمفضلة</p>
                </div>
            `;
        } else {
            container.innerHTML = favSurahs.map((s, index) => `
                <div class="track-card" onclick="playSurah(${surahs.indexOf(s)})">
                    <div class="track-num">${index + 1}</div>
                    <div style="flex:1">
                        <h4 style="font-size: 14px;">${s.title}</h4>
                        <p style="font-size: 11px; color: #78909c;">${s.reader}</p>
                    </div>
                    <i class="fas fa-heart" style="color: #ff4757; margin-right: 8px; font-size: 16px;" onclick="toggleFavorite(${s.id}, true); event.stopPropagation();"></i>
                    <i class="fas fa-play-circle" style="color: var(--primary); font-size: 18px;"></i>
                </div>
            `).join('');
        }
    }

    function renderRecent() {
        const container = document.getElementById('recentList');
        const recentSurahs = recent.map(id => surahs.find(s => s.id === id)).filter(s => s);
        
        if(recentSurahs.length === 0) {
            container.innerHTML = `
                <div class="empty-state">
                    <i class="far fa-clock"></i>
                    <h3>لا توجد تلاوات مستمع إليها</h3>
                    <p>سيتم عرض التلاوات التي تستمع إليها هنا</p>
                </div>
            `;
        } else {
            container.innerHTML = recentSurahs.map((s, index) => `
                <div class="track-card" onclick="playSurah(${surahs.indexOf(s)})">
                    <div class="track-num">${index + 1}</div>
                    <div style="flex:1">
                        <h4 style="font-size: 14px;">${s.title}</h4>
                        <p style="font-size: 11px; color: #78909c;">${s.reader}</p>
                    </div>
                    <i class="fas fa-history" style="color: var(--primary); margin-right: 8px; font-size: 16px;"></i>
                    <i class="fas fa-play-circle" style="color: var(--primary); font-size: 18px;"></i>
                </div>
            `).join('');
        }
    }

    function toggleFavorite(id, showNotificationFlag = false) {
        const index = favorites.indexOf(id);
        const surahIndex = surahs.findIndex(s => s.id === id);
        let message = '';
        
        if(index === -1) {
            favorites.push(id);
            surahs[surahIndex].favorite = true;
            message = 'تمت الإضافة إلى المفضلة';
        } else {
            favorites.splice(index, 1);
            surahs[surahIndex].favorite = false;
            message = 'تمت الإزالة من المفضلة';
        }
        
        localStorage.setItem('favorites', JSON.stringify(favorites));
        
        if (showNotificationFlag) {
            showNotification(message, 'success');
        }
        
        renderSurahs();
        renderFavorites();
    }

    function addToRecent(id) {
        recent = recent.filter(rId => rId !== id);
        recent.unshift(id);
        if(recent.length > 10) recent.pop();
        localStorage.setItem('recent', JSON.stringify(recent));
    }

    function playSurah(index) {
        currentIndex = index;
        const surah = surahs[currentIndex];
        audio.src = surah.src;
        
        document.getElementById('miniTitle').innerText = surah.title;
        document.getElementById('miniArtist').innerText = surah.reader;
        document.getElementById('fullTitle').innerText = surah.title;
        document.getElementById('fullArtist').innerText = surah.reader;
        
        audio.play();
        isPlaying = true;
        document.getElementById('playBtn').innerHTML = '<i class="fas fa-pause"></i>';
        document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
        
        addToRecent(surah.id);
        updateFavoriteButton();
        renderSurahs();
        
        document.getElementById('miniPlayer').classList.remove('hidden');
    }

    function updatePlayer() {
        const surah = surahs[currentIndex];
        document.getElementById('fullTitle').innerText = surah.title;
        document.getElementById('fullArtist').innerText = surah.reader;
        updateFavoriteButton();
    }

    function updateFavoriteButton() {
        const surah = surahs[currentIndex];
        document.getElementById('favoriteBtn').className = surah.favorite ? 'fas fa-heart' : 'far fa-heart';
        document.getElementById('favoriteBtn').style.color = surah.favorite ? '#ff4757' : 'white';
    }

    document.getElementById('playBtn').onclick = (e) => {
        e.stopPropagation();
        if(isPlaying) {
            audio.pause();
            document.getElementById('playBtn').innerHTML = '<i class="fas fa-play"></i>';
            document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-play"></i>';
        } else {
            audio.play();
            document.getElementById('playBtn').innerHTML = '<i class="fas fa-pause"></i>';
            document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
        }
        isPlaying = !isPlaying;
    };

    document.getElementById('fullPlayBtn').onclick = () => {
        if(isPlaying) {
            audio.pause();
            document.getElementById('playBtn').innerHTML = '<i class="fas fa-play"></i>';
            document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-play"></i>';
        } else {
            audio.play();
            document.getElementById('playBtn').innerHTML = '<i class="fas fa-pause"></i>';
            document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
        }
        isPlaying = !isPlaying;
    };

    document.getElementById('nextBtn').onclick = (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex + 1) % surahs.length;
        playSurah(currentIndex);
    };

    document.getElementById('fullNextBtn').onclick = () => {
        currentIndex = (currentIndex + 1) % surahs.length;
        playSurah(currentIndex);
    };

    document.getElementById('prevBtn').onclick = (e) => {
        e.stopPropagation();
        currentIndex = (currentIndex - 1 + surahs.length) % surahs.length;
        playSurah(currentIndex);
    };

    document.getElementById('fullPrevBtn').onclick = () => {
        currentIndex = (currentIndex - 1 + surahs.length) % surahs.length;
        playSurah(currentIndex);
    };

    document.getElementById('repeatBtn').onclick = () => {
        isRepeat = !isRepeat;
        document.getElementById('repeatBtn').style.color = isRepeat ? 'white' : 'rgba(255,255,255,0.7)';
        
        if (isRepeat) {
            showNotification('تم تفعيل وضع التكرار', 'info');
        } else {
            showNotification('تم إيقاف وضع التكرار', 'info');
        }
    };

    document.getElementById('favoriteBtn').onclick = () => {
        toggleFavorite(surahs[currentIndex].id, true);
        updateFavoriteButton();
    };

    function formatTime(time) {
        if (isNaN(time) || !isFinite(time)) return "0:00";
        const mins = Math.floor(time / 60);
        const secs = Math.floor(time % 60);
        return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    function setupProgressBar() {
        const progressBar = document.getElementById('progressBar');
        const progressContainer = document.getElementById('progressContainer');
        
        if (!progressContainer) {
            setTimeout(setupProgressBar, 100);
            return;
        }
        
        progressContainer.addEventListener('click', (e) => {
            if (!audio.duration || audio.duration <= 0) return;
            
            const rect = progressContainer.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const width = rect.width;
            const percentage = Math.max(0, Math.min(100, (x / width) * 100));
            
            const newTime = (percentage / 100) * audio.duration;
            audio.currentTime = newTime;
            progressBar.style.width = `${percentage}%`;
            
            document.getElementById('currentTime').innerText = formatTime(newTime);
            
            if (!isPlaying) {
                audio.play();
                isPlaying = true;
                document.getElementById('playBtn').innerHTML = '<i class="fas fa-pause"></i>';
                document.getElementById('fullPlayBtn').innerHTML = '<i class="fas fa-pause"></i>';
            }
        });
    }

    audio.addEventListener('timeupdate', () => {
        if (audio.duration && audio.duration > 0) {
            const progress = (audio.currentTime / audio.duration) * 100;
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = `${progress}%`;
            }
            
            const currentTimeElement = document.getElementById('currentTime');
            if (currentTimeElement) {
                currentTimeElement.innerText = formatTime(audio.currentTime);
            }
            
            const durationElement = document.getElementById('duration');
            if (durationElement && durationElement.textContent === '0:00') {
                durationElement.innerText = formatTime(audio.duration);
            }
        }
    });

    audio.addEventListener('loadedmetadata', () => {
        if (audio.duration && audio.duration > 0) {
            const durationElement = document.getElementById('duration');
            if (durationElement) {
                durationElement.innerText = formatTime(audio.duration);
            }
        }
    });

    audio.addEventListener('canplaythrough', () => {
        if (audio.duration && audio.duration > 0) {
            const durationElement = document.getElementById('duration');
            if (durationElement && durationElement.textContent === '0:00') {
                durationElement.innerText = formatTime(audio.duration);
            }
        }
    });

    audio.addEventListener('ended', () => {
        if(isRepeat) {
            audio.currentTime = 0;
            audio.play();
            showNotification('جاري تكرار التلاوة', 'info');
        } else {
            currentIndex = (currentIndex + 1) % surahs.length;
            playSurah(currentIndex);
        }
    });

    document.getElementById('searchInput').oninput = function(e) {
        const term = e.target.value.toLowerCase();
        const filtered = surahs.filter(s => s.title.includes(term) || s.reader.includes(term));
        renderSurahs(filtered);
    };

    surahs.forEach(s => {
        s.favorite = favorites.includes(s.id);
    });

    renderSurahs();
    renderQuran();
    audio.src = surahs[0].src;
    
    window.addEventListener('load', function() {
        setTimeout(setupProgressBar, 500);
    });
    
// --- قسم التحكم في إشعارات النظام المطور (Media Session) ---
(function() {
    if ('mediaSession' in navigator) {
        
        function updateMediaSession() {
            const surah = surahs[currentIndex];
            if (!surah) return;

            navigator.mediaSession.metadata = new MediaMetadata({
                title: surah.title,
                artist: surah.reader,
                album: 'تلاوات خاشعة',
                artwork: [
                    // تم وضع رابط أيقونة مسجد بجودة عالية للإشعار
                    { src: 'https://cdn-icons-png.flaticon.com/512/2904/2904975.png', sizes: '512x512', type: 'image/png' }
                ]
            });
        }

        audio.addEventListener('play', function() {
            updateMediaSession();
            navigator.mediaSession.playbackState = "playing";
        });

        audio.addEventListener('pause', function() {
            navigator.mediaSession.playbackState = "paused";
        });

        // أوامر التحكم من شريط الإشعارات أو سماعات الأذن
        navigator.mediaSession.setActionHandler('play', () => {
            audio.play();
            isPlaying = true;
            syncUI();
        });

        navigator.mediaSession.setActionHandler('pause', () => {
            audio.pause();
            isPlaying = false;
            syncUI();
        });

        navigator.mediaSession.setActionHandler('previoustrack', () => {
            currentIndex = (currentIndex - 1 + surahs.length) % surahs.length;
            playSurah(currentIndex);
            syncUI();
        });

        navigator.mediaSession.setActionHandler('nexttrack', () => {
            currentIndex = (currentIndex + 1) % surahs.length;
            playSurah(currentIndex);
            syncUI();
        });

        // إضافة دعم التقديم والتأخير من الإشعار (إذا كان النظام يدعم ذلك)
        navigator.mediaSession.setActionHandler('seekbackward', (details) => {
            audio.currentTime = Math.max(audio.currentTime - (details.seekOffset || 10), 0);
        });
        navigator.mediaSession.setActionHandler('seekforward', (details) => {
            audio.currentTime = Math.min(audio.currentTime + (details.seekOffset || 10), audio.duration);
        });
    }

    function syncUI() {
    const icon = isPlaying ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
    document.getElementById('playBtn').innerHTML = icon;
    document.getElementById('fullPlayBtn').innerHTML = icon;
    
    // إبلاغ النظام بتغيير الحالة فوراً ليظهر الإشعار أو يختفي
    if ('mediaSession' in navigator) {
        navigator.mediaSession.playbackState = isPlaying ? "playing" : "paused";
    }
}



</script>
</body>
</html>


